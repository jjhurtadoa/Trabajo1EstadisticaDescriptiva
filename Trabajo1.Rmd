---
title: "Primer_taller_grupal_sobre_encuesta_en_clase"
authors:"Omar David Mercado",
        "Zuleima Carriazo",
        "Juan Jose Hurtado Alvarez",
        "ESteban Grajales",
        "Juan Manuel"
email:  "omercado@unal.edu.co",
        "zcarriazo@unal.edu.co",
    
        "jgrajalesh@unal.edu.co" 
date: "Miercoles 7 de Abril de 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE
                      )
```


##### Valiendonos de las múltiples opciones que tenemos para presentar este proyecto, hacemos uso de esta biblioteca en particular
```{r}
library(tidyverse)
```

##### Se realiza la lectura de la base de datos de la que vamos a tomar información para realizar un analisis gráfico/exploratorio de lo que podamos encontrar en ella; se codifica con *UTF-08* para una lectura adecuada que permita tildes y letras en español.
```{r}
Enc <- read.csv("encuesta1.csv", encoding = "UTF-8")

```


##### Se muestran en el archivo los primeros 6 registros de la base de datos en cuestión, para dar una idea lo que pueda contener  ésta misma.
```{r}
head(Enc)
```

###### Se hace una revisión de las variables contenidas en la base de datos para mirar de que tipo son, y posteriormente convertirlas a otro tipo para trabajarlas a nuestra conveniencia
```{r}
glimpse(Enc)
```

```{r}
summary(Enc)
```


##### Se convierte el asignado de la primera variable **Respuesta** a tipo character pues se considera que con estas cifras no debemos hacer ningún tipo de cálculo matemático como para dejarla ser *entero* 
```{r}
enc <- Enc %>%
 mutate_if(is.integer, as.character)
```

##### Se cambian las variables de tipo caracter a factor para un adecuado manejo de
éstas en su análisis descriptivo
```{r}
enc <- enc %>%
  mutate_if(is.character, as.factor)
```

```{r}
summary(enc)
```

```{r}
glimpse(enc)
```



```{r}
enc <- enc %>%
  mutate(Q02_FechaNac = as.Date(as.character(Q02_FechaNac), '%Y-%m-%d'))
```

```{r}
summary(enc$Q02_FechaNac)
```

```{r}
enc <- enc %>%
  mutate(Edad= as.numeric(as.Date("2021-06-30") - Q02_FechaNac)/365.25)
```

```{r}
enc <- enc %>%
  mutate(fecha_entrega =
           as.POSIXct(strptime(Enviado.el.,format = "%d,/%m/%Y %H:%M:%S")),
         tiempo_usado = as.integer(format(fecha_entrega, "%M")) +
                        as.integer(format(fecha_entrega, "&S")) / 60 - 30)
```


```{r}
enc <- enc %>% 
  mutate(puntaje_pregunta2 = 
  apply(enc %>% select(Q26_Divisor..f.es.divisor.de.g.2.,
                            Q26_Divisor..f.es.divisor.de.gh.,
                            Q26_Divisor..f.es.divisor.de.h.g),
        1, sum))
t_p2 <- table(enc$puntaje_pregunta2)
t_p2
pt_p2 <- t_p2 / sum(t_p2) * 100
pt_p2
```


### La variable *Genero*, no requerirá hacer una depuración de los datos puesto que consideramos que se encuentra en orden dentro de la tabla original así que se procederá a representar dichos datos en su gráfica, para ello crearemos una tabla de frecuencias y su correspondiente valor porcentual.


```{r depuración de la variable ** Género**}
gen <- table(enc$Q01_Genero)
gen
```

```{r}
gen_p <- gen / sum(gen) * 100
gen_p
```


```{r}
paramAnt <- par(no.readonly = TRUE)
barplot(gen_p, las = 1,
        main  = "Distribución por género",
        ylim = c(0,100),
        col =c ('Black', 'violet', 'cyan'), 
        legend.text = c('Masculino', 'Femenino', 'Otro'))
text(bp1, gen_p + 7, paste(round(gen_p, 1), "%"))
grid(NA, 9)
par(paramAnt)
```

##### En la gráfica que representa la distribución por género se evidencia que la mayoría de los estudiantes que cursan esta asignatura son hombres, esto se debería a lo mejor a que la carrera es nueva y está mas enfocada en asuntos relacionados con la programación que desde tiempos anteriores se ha venido gestionando pr el género masculino



```{r}
summary(enc$Edad)
```

```{r}
hist(enc$Edad)
```

```{r}
hist(enc$Edad, nclass = 20)
```

```{r}
paramAnt <- par(no.readonly = TRUE)
hist(enc$Edad, freq = FALSE, nclass = 20, col = "violet",
     las = 1, 
     main = "Distribución de la edad",
     xlab = "Edad (años)",
     ylab = "Densidad",
     ylim = c(0, 0.20),
     xlim = c(15, 40))
lines(density(enc$Edad), col = "grey10", lwd = 5)
par(paramAnt)
```




#### Se filtra la fila en donde la variable **Q08_PAPA** presenta un error atípico y para tomar la decisión de corregir el dato, pues consideramos que pudo deberse a un error en la digitación de éste
```{r depuracion de la variable Q08_PAPA y analisis descriptivo}
enc %>%
  filter(Q08_PAPA > 5)
```

```{r}
enc$Q08_PAPA[enc$Q08_PAPA == 45 & !is.na(enc$Q08_PAPA)] <- 4.5
```


```{r}
summary(enc$Q08_PAPA)
```
###  Se toma la decisión de omitir los datos en *NA* ya que no hacen una gran representacion.
```{r}
enc$Q08_PAPA # FALTA
```

```{r}
hist(enc$Q08_PAPA)
```







```{r}
boxplot(Enc$Q08_PAPA, horizontal = TRUE)
```
```{r}
bxp1<-boxplot(Enc$Q08_PAPA, horizontal = TRUE,  notch= TRUE, col= 'violet')
title(main= 'Distribución_PAPA', font=2, xlab='Promedio Academico Ponderado Acumulado')
points(mean(enc$Q08_PAPA, na.rm=TRUE),1, col=' green', pch=19, cex=2)# agranda o disminuye el punto verde
legend(4.2,1.5, legend=c('Promedio'), pch=19, col= 'green')
```

```{r}
dotchart(enc$Q08_PAPA)
```

```{r}
promedioEdad <- mean(enc$Edad)
medianaEdad <- median(enc$Edad)
desv_Est_Edad <- sd(enc$Edad)

boxplot(enc$Edad, horizontal = TRUE,
        main = "Boxplot para edad", 
        col = "lightblue",
        pch = 19, notch = TRUE)
points(promedioEdad, 
       1, 
       pch = 19, 
       col = c("red", "purple"))
legend("topright", 
       title = "Convención",
       legend = c("Promedio", "Error estandard"), 
       col = "red", 
       pch = c(19, NA),
       lty = c(NA, 1))
arrows(promedioEdad -  desv_Est_Edad / sqrt(nrow(enc)), 1,
         promedioEdad + desv_Est_Edad / sqrt(nrow(enc)), 1,
         angle = 90,
         length = 0.1, 
         code = 3,
         col = "GREY10")
```

```{r}
table(enc$Q10_Estrato)
```

```{r}
barplot(table(enc$Q10_Estrato))
```



```{r}
with(enc, plot(Q10_Estrato, Q08_PAPA, notch = TRUE))
```
R

```{r}
enc_Estrato1 <- enc %>% 
  filter(Q10_Estrato == "2 : 1")
dotchart(enc_Estrato1$Q08_PAPA)
summary(enc_Estrato1$Q08_PAPA)
```


```{r}
with(enc, plot(Q03_Carrera, Q08_PAPA, notch = TRUE))
```


```{r}
with(enc, scatter.smooth(tiempo_usado, Q08_PAPA))
```


```{r}
with(enc, plot(Q27_PorcentDivisor))
lines(1:nrow(enc), rep(pt_p2[3], nrow(enc)), 
      col = "red")
```

```{r}
enc_acert_p2 <- enc %>% 
  filter(puntaje_pregunta2 == 3)
enc_no_acert_p2 <- enc %>% 
  filter(puntaje_pregunta2 != 3)
op <- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
prom_Q27 <- mean(enc_acert_p2$Q27)
with(enc_acert_p2, plot(Q27_PorcentDivisor, ylim = c(0, 100)))
lines(1:nrow(enc_acert_p2), rep(prom_Q27, nrow(enc_acert_p2)), 
      col = "red")
prom_Q27_na <- mean(enc_no_acert_p2$Q27, na.rm = TRUE, ylim = c(0, 100))
with(enc_no_acert_p2, plot(Q27_PorcentDivisor))
lines(1:nrow(enc_no_acert_p2), rep(prom_Q27_na, nrow(enc_no_acert_p2)), 
      col = "red")
par(op)
```







